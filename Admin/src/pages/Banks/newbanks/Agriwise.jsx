import React from 'react';
import html2canvas from 'html2canvas';
import jsPDF from 'jspdf';
import * as XLSX from 'xlsx';
import { saveAs } from 'file-saver';

export const AgriwiseFinanceReport = () => {
  const handleExportPDF = () => {
    const input = document.getElementById('reportTable');
    html2canvas(input, { scale: 2, useCORS: true }).then(canvas => {
      const imgData = canvas.toDataURL('image/png');
      const pdf = new jsPDF('p', 'mm', 'a4');

      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      const margin = 10;

      const imgWidth = pageWidth - margin * 2;
      const imgHeight = (canvas.height * imgWidth) / canvas.width;

      let position = margin;
      let remainingHeight = imgHeight;

      if (imgHeight > pageHeight - margin * 2) {
        while (remainingHeight > 0) {
          pdf.addImage(imgData, 'PNG', margin, position, imgWidth, imgHeight);
          remainingHeight -= pageHeight - margin * 2;
          if (remainingHeight > 0) {
            pdf.addPage();
            position = margin - (imgHeight - remainingHeight);
          }
        }
      } else {
        pdf.addImage(imgData, 'PNG', margin, margin, imgWidth, imgHeight);
      }

      pdf.save('Agriwise_Finance_Report.pdf');
    });
  };

  const handleExportExcel = () => {
    const table = document.getElementById('reportTable');
    const workbook = XLSX.utils.table_to_book(table, { sheet: 'Report' });
    const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
    const blob = new Blob([excelBuffer], { type: 'application/octet-stream' });
    saveAs(blob, 'Agriwise_Finance_Report.xlsx');
  };

  const handleExportCSV = () => {
    const table = document.getElementById('reportTable');
    const worksheet = XLSX.utils.table_to_sheet(table);
    const csv = XLSX.utils.sheet_to_csv(worksheet);
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    saveAs(blob, 'Agriwise_Finance_Report.csv');
  };

  return (
    <div style={{ padding: 10 }}>
      <div style={{ marginBottom: 20, textAlign: 'right' }}>
        <button onClick={handleExportPDF} style={{ marginRight: 10 }}>Download PDF</button>
        <button onClick={handleExportExcel} style={{ marginRight: 10 }}>Download Excel</button>
        <button onClick={handleExportCSV}>Download CSV</button>
      </div>

      <div className="valuation-report">
        <table id="reportTable" cellSpacing="0" cellPadding="0">
        <colgroup>
          <col width="33" />
          <col width="66" />
          <col width="67" />
          <col width="129" />
          <col width="72" />
          <col width="181" />
          <col width="194" />
          <col width="143" />
          <col width="136" />
          <col width="66" />
          <col width="67" />
          <col width="57" />
        </colgroup>
        <tbody>
          <tr>
            <td className='text-center font-boldi' colSpan="12">AGRIWISE FINANCE LIMITED</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Name of Valuation Agency</td>
            <td colSpan="3">Unique engineering and associate</td>
            <td colSpan="3">Date of Valuation</td>
            <td colSpan="2">08.01.2024</td>
          </tr>
          <tr>
            <td>A.</td>
            <td className=' font-boldi' colSpan="11">Technical Initiation Request Form Data</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Proposal No</td>
            <td colSpan="3">DSSECBHO0013111<br /><br /></td>
            <td colSpan="2">Case Type</td>
            <td colSpan="3">LAP</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Date of Inspection / Site visit</td>
            <td colSpan="3">08.01.2024</td>
            <td colSpan="2">Nearest Landmark</td>
            <td colSpan="3">SBI BANK</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="5">Name of the Customer/ Applicant &amp; Contact Details</td>
            <td className=' font-boldi' colSpan="6">Mr. Narendra Chouhan</td>
          </tr>
          <tr>
            <td><u>&nbsp;</u></td>
            <td colSpan="5">Name of Current Owner / Seller</td>
            <td colSpan="6">Mrs. Jamvati bai w/o mr. pritam singh</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="4" rowSpan="3">Address of the property being appraised</td>
            <td>(As per TRF)</td>
            <td colSpan="6">property is resi cum commercial house situated at part of kh. No. 88/4, p.h.no. 20, r.n.m.- 02, gram- Dobi, tehsil- Budni, dist. sehore, m.p. 466554</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>As per Document</td>
            <td colSpan="6">property is resi cum commercial house situated at part of kh. No. 88/4, p.h.no. 20, r.n.m.- 02, gram- Dobi, tehsil- Budni, dist. sehore, m.p. 466554</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>As per Actual at site</td>
            <td colSpan="6">property is resi cum commercial house situated at part of kh. No. 88/4, p.h.no. 20, r.n.m.- 02, gram- Dobi, tehsil- Budni, dist. sehore, m.p. 466554</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="5">Documents Provided by SFL</td>
            <td colSpan="6">SALE DEED</td>
          </tr>
          <tr>
            <td>B.</td>
            <td className=' font-boldi' colSpan="11">Locational &amp; Property Specific Details (based on site visit)</td>
          </tr>
          <tr>
            <td rowSpan="11">&nbsp;</td>
            <td colSpan="3">Status of Land Holding</td>
            <td colSpan="2">FRESS HOLD</td>
            <td colSpan="2">Developed By</td>
            <td colSpan="4">NA</td>
          </tr>
          <tr>
            <td colSpan="3">Type of Property</td>
            <td colSpan="2">COMMERCIAL AND RESIDENTIAL</td>
            <td colSpan="2">Type of Locality</td>
            <td colSpan="4">RESIDENTIAL AND COMMERCIAL</td>
          </tr>
          <tr>
            <td colSpan="3">Date of Inspection / Site visit</td>
            <td colSpan="2">08.01.2024</td>
            <td colSpan="2">Occupation Status</td>
            <td colSpan="4">OCCUPIED</td>
          </tr>
          <tr>
            <td colSpan="3">Location/Zoning as per Master Plan</td>
            <td colSpan="2">na</td>
            <td colSpan="2">Property Usage</td>
            <td colSpan="4">COMMERCIAL AND RESIDENTIAL</td>
          </tr>
          <tr>
            <td colSpan="3">Plot Demarcation</td>
            <td colSpan="2">YES</td>
            <td colSpan="2">Property Identifiable</td>
            <td colSpan="4">NO</td>
          </tr>
          <tr>
            <td colSpan="3">Identified Through</td>
            <td colSpan="2">NOT IDENTIFIED</td>
            <td colSpan="2">Within MC / GP Limit</td>
            <td colSpan="4">GP LIMIT</td>
          </tr>
          <tr>
            <td colSpan="3">Internal Finishing</td>
            <td colSpan="2">AVEARGE</td>
            <td colSpan="2">Type of Structure</td>
            <td colSpan="4">RCC</td>
          </tr>
          <tr>
            <td colSpan="3">No. of Floors in the building</td>
            <td colSpan="2">g+1</td>
            <td colSpan="2">Located on Floor No.</td>
            <td colSpan="4">G+1 FLOOR</td>
          </tr>
          <tr>
            <td colSpan="3">Total No. of Flats / Unit in building</td>
            <td colSpan="2">N/A</td>
            <td colSpan="2">Year of Completion of Property</td>
            <td colSpan="4">2015</td>
          </tr>
          <tr>
            <td colSpan="3">Construction Stage of the Property (in %)</td>
            <td colSpan="2">100%</td>
            <td colSpan="2">Disbursement Recommended (in %)</td>
            <td colSpan="4">100%</td>
          </tr>
          <tr>
            <td colSpan="3">Age of the Property In Year</td>
            <td colSpan="2">8</td>
            <td colSpan="2">Future Physical Life of Property in Year</td>
            <td colSpan="4">42</td>
          </tr>
          <tr>
            <td>C.</td>
            <td className=' font-boldi' colSpan="11">Boundaries</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">DIRECTIONS</td>
            <td colSpan="2">EAST</td>
            <td>WEST</td>
            <td colSpan="2">NORTH</td>
            <td colSpan="3">SOUTH</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">As per Documents</td>
            <td colSpan="2">REMAINING LAND</td>
            <td>B.K. SINGH</td>
            <td colSpan="2">REMAINING LAND</td>
            <td colSpan="3">ROAD</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">As per najariya naksha</td>
            <td colSpan="2">NA</td>
            <td>NA</td>
            <td colSpan="2">NA</td>
            <td colSpan="3">NA</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">As per Site / Actual</td>
            <td colSpan="2">PRIVATE 10 FT ROAD THAN HOUSE OF PRADEEP</td>
            <td>OPEN PLOT OF B.K. SINGH</td>
            <td colSpan="2">LAND OF BHAGWAN DAS</td>
            <td colSpan="3">MAIN ROAD</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Boundaries Matching</td>
            <td>NO</td>
            <td colSpan="2">If No, then reason thereon</td>
            <td colSpan="5">NOT IDENTIFIED</td>
          </tr>
          <tr>
            <td>D.</td>
            <td className=' font-boldi' colSpan="11">Setbacks / MarginB41:L42B41</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Setbacks / Margin in the Building (in Ft)</td>
            <td colSpan="2">Front</td>
            <td>Rear</td>
            <td colSpan="2">Left Side</td>
            <td colSpan="3">Right Side</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">As per sanctioned/ permissible byelaws</td>
            <td colSpan="2">NA</td>
            <td>NA</td>
            <td colSpan="2">NA</td>
            <td colSpan="3">NA</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">As per Site / Actual</td>
            <td colSpan="2">NA</td>
            <td>NA</td>
            <td colSpan="2">NA</td>
            <td colSpan="3">NA</td>
          </tr>
          <tr>
            <td>E.</td>
            <td className='font-boldi' colSpan="11">Height/Stories</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="6">As per sanctioned/ permissible bye laws</td>
            <td colSpan="5">NA</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="6">As per Site / Actual</td>
            <td colSpan="5">NA</td>
          </tr>
          <tr>
            <td>F.</td>
            <td className=' font-boldi' colSpan="11">Built-up Area &amp; Accommodation Details</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Floor (Pl mention floor wise)</td>
            <td colSpan="2">Accommodation</td>
            <td>Carpet Area (Sft)</td>
            <td>Actual SBUA (Sft)</td>
            <td>Permissible BUA (Sft)</td>
            <td colSpan="3">Adopted Built-up area (Sft)</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Basement / Stilt</td>
            <td colSpan="2">&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Ground Floor</td>
            <td colSpan="2">4SHOP +3H+1k</td>
            <td>1300</td>
            <td>2000</td>
            <td>1500</td>
            <td colSpan="3">1500</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">First Floor</td>
            <td colSpan="2">4SHOP +4R+1K+1LB</td>
            <td>1300</td>
            <td>2000</td>
            <td>1500</td>
            <td colSpan="3">1500</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">TEEN SHED AREA</td>
            <td colSpan="2">&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td colSpan="3">&nbsp;</td>
          </tr>
          <tr>
            <td align="right">0</td>
            <td colSpan="3">Sixth Floor</td>
            <td colSpan="2">&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td colSpan="3">&nbsp;</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Total</td>
            <td colSpan="2">&nbsp;</td>
            <td>2600</td>
            <td>4000</td>
            <td>3000</td>
            <td colSpan="3">3000</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Violation observed if any</td>
            <td colSpan="8">&nbsp;</td>
          </tr>
          <tr>
            <td>G.</td>
            <td className=' font-boldi' colSpan="11">Plan Approvals</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="5">Construction as per approved/ sanctioned plans</td>
            <td>NA</td>
            <td colSpan="3">Details of approved plan with approval no and date</td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="5">Construction permission Number and date</td>
            <td>NA</td>
            <td colSpan="3">Violations Observed if Any</td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="7">If plans not available then is the structure confirming to the local byelaws.</td>
            <td colSpan="4">NA</td>
          </tr>
          <tr>
            <td>H.</td>
            <td className=' font-boldi' colSpan="11">Estimate Analysis (Applicable only in Self Construction cases)</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="5">Estimated Cost (In Rs)</td>
            <td>NA</td>
            <td colSpan="3">Estimated Cost (in Rs per Sqft)</td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="5">Justified Estimated Cost (in Rs per Sqft)</td>
            <td>NA</td>
            <td colSpan="3">Adoptable / Justified Estimated Cost (In Rs)</td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td>I.</td>
            <td className=' font-boldi' colSpan="11">Valuation of Property (Fair Market Valuation / Distress Valuation)</td>
          </tr>
          <tr>
            <td rowSpan="10">&nbsp;</td>
            <td colSpan="4">Land Area (In Sqft)</td>
            <td>2000</td>
            <td colSpan="3">Adoptable Built-up Area (in Sqft) FOR RCC</td>
            <td colSpan="2">3000</td>
            <td>SQFT</td>
          </tr>
          <tr>
            <td colSpan="4">Current Market Rate of land in the locality (Range) in Rs Per Sqft</td>
            <td>0</td>
            <td colSpan="3">Construction Cost (Rs per sft)</td>
            <td colSpan="2">0</td>
            <td>SQFT</td>
          </tr>
          <tr>
            <td colSpan="4">Recommended Rate of Land (Rs per sqft)</td>
            <td>0</td>
            <td colSpan="3">Total Construction Value for 100% complete building (in Rs)</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td colSpan="4">Total Land Value (in Rs)</td>
            <td>0</td>
            <td colSpan="3">Total Construction Value for present construction stage (in Rs)</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td colSpan="4">Market Value of Land &amp; Building for 100% complete property (in Rs)</td>
            <td>0</td>
            <td colSpan="3">Market Value of Land &amp; Building for present completed property (in Rs)</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td colSpan="4">Distress Value of 100% complete property @ 60% of MV</td>
            <td>0</td>
            <td colSpan="3">Distress Value of present completed property @ 50% of MV (As on date) (in Rs)</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td colSpan="4">Flat / Apartment / Shop / Office BUA (in Sqft)</td>
            <td>&nbsp;</td>
            <td colSpan="3">Composite sale rate (Rs per sqft)</td>
            <td colSpan="3">&nbsp;</td>
          </tr>
          <tr>
            <td colSpan="7">Total Market Value of Apartment / Shop / Flat / Office (Rs per sqft)</td>
            <td colSpan="4">0</td>
          </tr>
          <tr>
            <td colSpan="4">Government Guideline/ Circle rate for Land (Rs per sqft)</td>
            <td>0</td>
            <td colSpan="3">Land Value as per Government Rate (Rs)</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td colSpan="4">Government Guideline/ Circle rate for Flats (Rs per sqft)</td>
            <td>0</td>
            <td colSpan="3">Flat / Apartment Value as per Government Rate (Rs)</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td>J.</td>
            <td className=' font-boldi' colSpan="11">Property Specific Remarks &amp; Observation</td>
          </tr>
          <tr>
            <td rowSpan="3">&nbsp;</td>
            <td colSpan="2" rowSpan="3">RENARKS/ OBSERVATION</td>
            <td colSpan="9" rowSpan="3">
              1.GIVEN XEROX COPY OF SALE DEED IS IN FAVOUR OF SMT. JAMVATI BAI W/O MR. PRITAM SINGH .<br />
              2 DURING PROPERTY VISIT MR. NARENDRA CHOUHAN JI MET AT THE PROPERTY HE IS THE CUSTOMER CONTACT NO. 9340034032. IT WAS CLEARLY EXPLAINED TO HIM THAT THE PROPERTY VISIT IS BEING DONE FOR VALUATION PURPOSE IN RELATION WITH LOAN PROPOSAL.<br />
              3 RATE HAS BEEN CONFORM FROM MARKET ENQUIRY.<br />
              4. THE PROPERTY IS SITUATED AT SURROUNDING AREA OF AGRICULTURAL CUM COMMERCIAL ZONING SURROUNDING AREA DEVELOPMENT 40-50%. <br />
              5. AT SITE PROPERTY IS G+1 RSI CUM COMMERCIAL WHERE G.F HAVING 4 SHOP +3HALL+1KITCHIN AND F.F HAVING 4SHOP +4R+1K+1LB OCCUPIED BY CUSTOMER AT SITE. <br />
              6. G+1 STRUCTURE BUILD OVER THE PLOT AREA 40X50=2000 SQFT. <br />
             <span className='text-danger'>7. PROPERTY IS NOT IDENTIFIED BY FOUR SIDE BOUNDARIES OF THE SALE DEED ANY APPROVER NAJARIYA NAKSHA OR KEY LOCATION PLAN IS REQUIRED FOR IDENTIFICATION. <br /></span>
              8.OBTAIN BUILDING MAP FOR G+2 STRUCTURE WHICH IS APPROVED BY GRAM PANCHAYT DOBI. DATE AND MEMO NO. NOT MENTIONED <br />
              9. BUILT UP IS TAKEN AS PER PERMISSIBLE FAR 1.5 FAR <br />
              10. AS PER SALE DEED LAND USES ARE FOR RESIDENTIAL PROPOSES AND AS PER TAX RECEIPT LAND USES ARE RESIDENTIAL AND COMMERCIAL <br />
              12. TENTATIVE LAND RATE IS RS 2500 PER SQFT.<br />
              <br />
              <br />
            </td>
          </tr>
          <tr></tr>
          <tr></tr>
          <tr>
            <td>K.</td>
            <td className='font-boldi' colSpan="11">Value Certification</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Date of Visit</td>
            <td colSpan="2">08.01.2024</td>
            <td colSpan="3">Date of Report Submission</td>
            <td colSpan="3">&nbsp;</td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td colSpan="3">Name of Engineer VisIted the property</td>
            <td colSpan="2">BHART SHARMA</td>
            <td colSpan="3">Authorized Signatory Name &amp; Signature</td>
            <td colSpan="3">&nbsp;</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="12">DECLARATIONSS</td>
          </tr>
          <tr>
            <td rowSpan="4">&nbsp;</td>
            <td colSpan="11" rowSpan="4">
              1. We have deputed our representative Mr. BHAGWAT to inspect the property. Our representative has personally inspected the property on 25.05.2023<br />
              2. We have no direct / indirect interest in the property valued<br />
              3. the valuation is based on the site visit and the information given by borrower<br />
              4. The information furnished above is true and correct to the best of our knowledge and belief and as per actual position &amp; information given to us and is based on the copy of documents / plans, if submitted to us by the Bank or shown to us by the client<br />
              5. No assistance was received in the preparation of the appraisal, in the property valued<br />
              6. The contents of this report are for technical valuation and should not be read in any legal context <br />
              7. Inspection of the property was informed<br />
              8. Limiting conditions have been disclosed<br />
              9. The valuation is subject and marketable title and adequacy of engineering design<br />
              10. The contents of this report are for technical valuation and should not be read in any legal context. The fair market value indicated in the report is an opinion of the value prevailing on the date of the said report and is based on market feedback on values of similar properties. The client is free to obtain other independent opinions on the same. The fair market value of such properties / localities may increase or decrease, depending on the future market conditions and scenarios. The valuation is subject to clear &amp; marketable title &amp; adequacy of engineering design.<br />
            </td>
          </tr>
          <tr></tr>
          <tr></tr>
          <tr></tr>
        </tbody>
      </table>
    </div>
    </div>
  );
};

export default AgriwiseFinanceReport;