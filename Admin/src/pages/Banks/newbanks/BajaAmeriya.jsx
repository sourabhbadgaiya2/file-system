import React from 'react';
import html2canvas from 'html2canvas';
import jsPDF from 'jspdf';
import * as XLSX from 'xlsx';
import { saveAs } from 'file-saver';

export const BajaAmeriya = () => {
  const handleExportPDF = () => {
    const input = document.getElementById('reportTable');
    html2canvas(input, { scale: 2, useCORS: true }).then(canvas => {
      const imgData = canvas.toDataURL('image/png');
      const pdf = new jsPDF('p', 'mm', 'a4');

      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      const margin = 10;

      const imgWidth = pageWidth - margin * 2;
      const imgHeight = (canvas.height * imgWidth) / canvas.width;

      let position = margin;
      let remainingHeight = imgHeight;

      if (imgHeight > pageHeight - margin * 2) {
        while (remainingHeight > 0) {
          pdf.addImage(imgData, 'PNG', margin, position, imgWidth, imgHeight);
          remainingHeight -= pageHeight - margin * 2;
          if (remainingHeight > 0) {
            pdf.addPage();
            position = margin - (imgHeight - remainingHeight);
          }
        }
      } else {
        pdf.addImage(imgData, 'PNG', margin, margin, imgWidth, imgHeight);
      }

      pdf.save('Baja_Ameriya_Report.pdf');
    });
  };

  const handleExportExcel = () => {
    const table = document.getElementById('reportTable');
    const workbook = XLSX.utils.table_to_book(table, { sheet: 'Report' });
    const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
    const blob = new Blob([excelBuffer], { type: 'application/octet-stream' });
    saveAs(blob, 'Baja_Ameriya_Report.xlsx');
  };

  const handleExportCSV = () => {
    const table = document.getElementById('reportTable');
    const worksheet = XLSX.utils.table_to_sheet(table);
    const csv = XLSX.utils.sheet_to_csv(worksheet);
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    saveAs(blob, 'Baja_Ameriya_Report.csv');
  };

  return (
    <div style={{ padding: 10 }}>
      <div style={{ marginBottom: 20, textAlign: 'right' }}>
        <button onClick={handleExportPDF} style={{ marginRight: 10 }}>Download PDF</button>
        <button onClick={handleExportExcel} style={{ marginRight: 10 }}>Download Excel</button>
        <button onClick={handleExportCSV}>Download CSV</button>
      </div>

      <div id="radio" className="valuation-report w-100 h-100">
      <table id="reportTable" cellSpacing="0" cellPadding="0" style={{ width: "100%", height: "100%" }}>

        <colgroup>
          <col width="75" />
          <col width="101" />
          <col width="97" />
          <col width="99" />
          <col width="99" />
          <col width="93" />
          <col width="97" />
          <col width="93" />
        </colgroup>
        <tbody>
          <tr>
            <td width="75"><a name="RANGE!A1:H103"></a></td>
            <td width="101"></td>
            <td width="97"></td>
            <td className='font-boldi' colSpan="2">Agency Name:</td>
            <td className='font-boldi' colSpan="3">AMERIYA ENGINEERING PVT. LTD.</td>
          </tr>
          <tr>
            <td className='font-boldi text-center' colSpan="8">PROPERTY VALUATION REPORT</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Applicant Details</td>
          </tr>
          <tr>
            <td colSpan="2">File No./LAN No./SFDC No.</td>
            <td colSpan="2">SME000006389870</td>
            <td colSpan="2">Date of Report</td>
            <td colSpan="2">20.03.2023</td>
          </tr>
          <tr>
            <td colSpan="2">Name of<br />Applicant/Co-Applicant</td>
            <td colSpan="2">SHRI SIDDHI VINAYAK CUSTOMER SERVICE POINT</td>
            <td colSpan="2">Contact Person Name and No.</td>
            <td colSpan="2">RATNESH PATEL <br />CONT NO.- 7879776849</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="2">Loan Type</td>
            <td colSpan="2">BLSE</td>
            <td className='font-boldi' colSpan="2">Person Met at Site</td>
            <td colSpan="2">RATNESH PATEL <br />CONT NO.- 7879776849</td>
          </tr>
          <tr>
            <td colSpan="4">Name of Property Owner as per Legal Document</td>
            <td colSpan="4">(1) MR. RAJNEESH PATEL S/O MR. INDRAKESHWAR PATEL <br />(2) MR. RATNESH PATEL S/O MR. INDRAKESHWAR PATEL.</td>
          </tr>
          <tr>
            <td colSpan="4">Documents Provided</td>
            <td colSpan="4">SALE DEED NO. MP182542020A1914263 ON DATED 31.12.2020</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">3</td>
          </tr>
          <tr>
            <td className='font-boldi' rowSpan="4" width="75">Address of Property</td>
            <td>Postal Address of the Property:</td>
            <td colSpan="6">PROPERTY PART OF KH NO. 557/2, PH NO. 59, PATEL MOHALLA, MAUJA BARGI RNM SALICHOUKA, JABALPUR TEHSIL AND DIST JABALPUR MP-482051</td>
          </tr>
          <tr>
            <td>Locality Name:</td>
            <td colSpan="6">PATEL MOHALLA</td>
          </tr>
          <tr>
            <td>Landmark Nearby</td>
            <td colSpan="3">NEAR BAMBAM HOTEL</td>
            <td colSpan="2">Distance from(Name of the Hub)</td>
            <td>2-3 Km</td>
          </tr>
          <tr>
            <td>Legal Address of the Property:</td>
            <td colSpan="6">PROPERTY PART OF KH NO. 557/2, PH NO. 59, PATEL MOHALLA, MAUJA BARGI RNM SALICHOUKA, JABALPUR TEHSIL AND DIST JABALPUR MP-482051</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Address Matching</td>
            <td colSpan="2">Yes</td>
            <td colSpan="3">Jurisdiction / Local Municipal Body / GP</td>
            <td colSpan="2">NAGAR NIGAM</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Property Holding Type</td>
            <td colSpan="2">Freehold</td>
            <td colSpan="3">Marketability</td>
            <td colSpan="2">GOOD</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Type of Property</td>
            <td colSpan="7">RESIDENTIAL HOUSE</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Occupancy Status</td>
            <td colSpan="7">SELF</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Distance from NH/SH</td>
            <td colSpan="7">100 METER</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="2">Schedule of Property</td>
            <td className='font-boldi' colSpan="6">As per legal documents</td>
          </tr>
          <tr>
            <td colSpan="2">East</td>
            <td colSpan="6">PLOT OF KISHORE CHOUKSEY</td>
          </tr>
          <tr>
            <td colSpan="2">West</td>
            <td colSpan="6">SIDE ROAD</td>
          </tr>
          <tr>
            <td colSpan="2">North</td>
            <td colSpan="6">HOUSE OF BAMHNE JI</td>
          </tr>
          <tr>
            <td colSpan="2">South</td>
            <td colSpan="6">SIDE ROAD</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="2">Schedule of Property</td>
            <td className='font-boldi' colSpan="6">As per Site Visit</td>
          </tr>
          <tr>
            <td colSpan="2">East</td>
            <td colSpan="6">PLOT OF KISHORE CHOUKSEY</td>
          </tr>
          <tr>
            <td colSpan="2">West</td>
            <td colSpan="6">KACCHA ROAD</td>
          </tr>
          <tr>
            <td colSpan="2">North</td>
            <td colSpan="6">HOUSE OF BAMHNE JI</td>
          </tr>
          <tr>
            <td colSpan="2">South</td>
            <td colSpan="6">15 FT ROAD</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="2">Schedule of Property</td>
            <td className='font-boldi' colSpan="6">As per Plan</td>
          </tr>
          <tr>
            <td colSpan="2">East</td>
            <td colSpan="6">NA</td>
          </tr>
          <tr>
            <td colSpan="2">West</td>
            <td colSpan="6">NA</td>
          </tr>
          <tr>
            <td colSpan="2">North</td>
            <td colSpan="6">NA</td>
          </tr>
          <tr>
            <td colSpan="2">South</td>
            <td colSpan="6">NA</td>
          </tr>
          <tr>
            <td colSpan="3">Boundary Mismatch</td>
            <td>MATCH</td>
            <td colSpan="3">Property Identified</td>
            <td>YES</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Approved Plan Details</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="3" rowSpan="5">Approved Plan Details</td>
            <td colSpan="3">Layout Plan Details:<br /></td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td colSpan="3">Construction Plan Details:</td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td colSpan="3">Plan Validity:</td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td colSpan="3">Approved Authority:</td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td colSpan="3">Approved Usage:</td>
            <td colSpan="2">NA</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Technical Details</td>
          </tr>
          <tr>
            <td colSpan="5">Construction Quality</td>
            <td colSpan="3">GOOD</td>
          </tr>
          <tr>
            <td colSpan="5">No. of Lifts</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td colSpan="5">Current Occupant of Property</td>
            <td colSpan="3">SHRI SIDDHI VINAYAK CUSTOMER SERVICE POINT</td>
          </tr>
          <tr>
            <td colSpan="5">Accommodation Details (Floor-wise Occupancy)</td>
            <td colSpan="3">G+2- ONE COMPANY TENANT</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Built Up Area Details</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">S.No.</td>
            <td className='font-boldi' width="101">Floor Level</td>
            <td className='font-boldi' width="97">No. of Rooms</td>
            <td className='font-boldi' width="99">No. of Kitchens</td>
            <td className='font-boldi' width="99">No. of Bathrooms</td>
            <td className='font-boldi' width="93">No. of Halls</td>
            <td className='font-boldi' width="97">Sanction Usage</td>
            <td className='font-boldi' width="93">Actual Usage</td>
          </tr>
          <tr>
            <td width="75">1</td>
            <td width="101">G.F</td>
            <td width="97">12</td>
            <td width="99">4</td>
            <td width="99">4</td>
            <td width="93">&nbsp;</td>
            <td width="97">RESIDENTIAL</td>
            <td width="93">RESIDENTIAL</td>
          </tr>
          <tr>
            <td width="75">2</td>
            <td width="101">F.F.</td>
            <td width="97">12</td>
            <td width="99">4</td>
            <td width="99">4</td>
            <td width="93">&nbsp;</td>
            <td width="97">RESIDENTIAL</td>
            <td width="93">RESIDENTIAL</td>
          </tr>
          <tr>
            <td width="75">3</td>
            <td width="101">S.F.</td>
            <td width="97">12</td>
            <td width="99">4</td>
            <td width="99">4</td>
            <td width="93">&nbsp;</td>
            <td width="97">RESIDENTIAL</td>
            <td width="93">RESIDENTIAL</td>
          </tr>
          <tr>
            <td colSpan="5">Additional Structures</td>
            <td colSpan="3">NA</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Plot Area Details</td>
          </tr>
          <tr>
            <td colSpan="2">Plot Area Details</td>
            <td colSpan="2">As per Docs</td>
            <td colSpan="2">As per Plan</td>
            <td colSpan="2">As per Site Visit</td>
          </tr>
          <tr>
            <td colSpan="2">East to West</td>
            <td colSpan="2">IRREGULAR</td>
            <td colSpan="2">NA</td>
            <td colSpan="2">IRREGULAR</td>
          </tr>
          <tr>
            <td colSpan="2">North to South</td>
            <td colSpan="2">IRREGULAR</td>
            <td colSpan="2">NA</td>
            <td colSpan="2">IRREGULAR</td>
          </tr>
          <tr>
            <td colSpan="2">Land Area (in Sq feet)</td>
            <td colSpan="2">1767</td>
            <td colSpan="2">NA</td>
            <td colSpan="2">1767</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Permissible Area Details</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Floor Level</td>
            <td className='font-boldi' width="101">Permissible Area as per Plan</td>
            <td className='font-boldi' width="97">Land Component</td>
            <td className='font-boldi' width="99">Permissible FSI</td>
            <td className='font-boldi' width="99">Permissible Construction as per FSI</td>
            <td className='font-boldi' width="93">140% of Permissible Construction</td>
            <td className='font-boldi' width="97">Actual Construction (BUA)</td>
            <td className='font-boldi' width="93">FSI Violation %</td>
          </tr>
          <tr>
            <td width="75">G. F.</td>
            <td width="101">0</td>
            <td width="97">1767</td>
            <td width="99">1.25</td>
            <td width="99">2208.75</td>
            <td width="93">3092.25</td>
            <td width="97">5301</td>
            <td width="93">0</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="4">Risk of Demolition</td>
            <td colSpan="4">Low</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="4">Valuation done as per BFL BSL Norms:</td>
            <td colSpan="4">NO</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="4">Status of the Property</td>
            <td width="99">100%</td>
            <td className='font-boldi' colSpan="2">% Completion</td>
            <td width="93">100%</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="4">Current Age of Property In Year</td>
            <td width="99">2</td>
            <td className='font-boldi' colSpan="2">Residual Age of Property</td>
            <td width="93">58</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Items</td>
            <td className='font-boldi' colSpan="2">Area Details in Sft.</td>
            <td className='font-boldi' colSpan="2">Rate Per Sft. (in Rs)</td>
            <td className='font-boldi' colSpan="3">Total Value (in Rs)</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Land Value</td>
            <td colSpan="2">1767</td>
            <td colSpan="2">1000</td>
            <td colSpan="3">1767000</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">BUA Value (RCC)</td>
            <td colSpan="2">3092</td>
            <td colSpan="2">1300</td>
            <td colSpan="3">4019600</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Depreciation</td>
            <td colSpan="7">0</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Covered Car Parking</td>
            <td colSpan="7">0</td>
          </tr>
          <tr>
            <td className='font-boldi' width="75">Amenities / Other Charges</td>
            <td colSpan="7">0</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="5">Fair Market Value as on Date (Rs)</td>
            <td colSpan="3">5786600</td>
          </tr>
          <tr>
            <td colSpan="5">Govt. Value (Land Value only) (Rs)</td>
            <td colSpan="3">RS. 817/- PER SQFT</td>
          </tr>
          <tr>
            <td colSpan="5">Distressed / Forced Value (Rs)</td>
            <td colSpan="3">4339950</td>
          </tr>
          <tr>
            <td colSpan="5">Valuation Done Earlier</td>
            <td colSpan="3">No</td>
          </tr>
          <tr>
            <td colSpan="5">In Municipal / Development Authority Demolition List</td>
            <td colSpan="3">No</td>
          </tr>
          <tr>
            <td colSpan="5">Is Property in Negative Area</td>
            <td colSpan="3">No</td>
          </tr>
          <tr>
            <td width="75">Remarks:</td>
            <td colSpan="7">
              1. OBTAIN XEROX COPY OF SALE DEED IS IN FAVOUR OF (1) MR. RAJNEESH PATEL S/O MR. INDRAKESHWAR PATEL (2) MR. RATNESH PATEL S/O MR. INDRAKESHWAR PATEL. <br />
              2. DURING PROPERTY VISIT RATNESH JI MET AT THE PROPERTY WHO IS THE CUSTOMER CONTACT NO. 7879776849. IT WAS CLEARLY EXPLAINED TO HIM THAT THE PROPERTY VISIT IS BEING DONE FOR VALUATION PURPOSE IN RELATION WITH LOAN PROPOSAL.<br />
              3. RATE HAS BEEN CONFORM FROM MARKET INQUIRY.<br />
              4. PROPERTY IS SITUATED AT SURROUNDING AREA OF LOCALITY IS RESIDENTIAL ZONING.<br />
              5. SUBJECT PROPERTY IS G+2 RESIDENTIAL HOUSE WHICH IS RENTED TO ONE COMPANY AND OCCUPIED BY COMPANY EMPLOYEE.<br />
              6. AT SITE G+2 RCC STRUCTURE IS CONSTRUCTED ON 1767 SQFT EACH FLOOR.<br />
              7. BUILT UP IS TAKEN FROM PERMISSIBLE FAR (1.25) WITH BHFL NORMS.<br />
              8. PROPERTY IS IDENTIFIED BY FOUR SIDE BOUNDARIES OF GIVEN DEED AND LOCAL ENQUIRY.<br />
              9. BUILDING PERMISSION MAP AND PTR NOT OBTAIN.<br />
              10. AS PER DEED PROPERTY IS RESIDENTIAL DIVERTED.<br />
              11. SUGGEST TO CREDIT TEAM TO BE CHECK PROPER OWNERSHIP DOCUMENT PRIOR DISBURSEMENT.<br />
              12. REPORT IS RELEASE SUBJECT TO TECHNICAL TEAM APPROVAL.<br />
            </td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Additional Checks for Panchayat Properties</td>
          </tr>
          <tr>
            <td colSpan="5">Approach Road to the Property</td>
            <td colSpan="3">Public</td>
          </tr>
          <tr>
            <td colSpan="5">Development of Surrounding Areas to Property</td>
            <td colSpan="3">Developed (Over 80% units occupied)</td>
          </tr>
          <tr>
            <td colSpan="5">Distance from City Centre in Km</td>
            <td colSpan="3">0</td>
          </tr>
          <tr>
            <td colSpan="5">Distance from Corporation Limits in Km<br />Bus Stop in case whether there is no Municipal Body</td>
            <td colSpan="3">1</td>
          </tr>
          <tr>
            <td colSpan="5">Electricity</td>
            <td colSpan="3">Available</td>
          </tr>
          <tr>
            <td colSpan="5">Electricity Distributor</td>
            <td colSpan="3">Govt.</td>
          </tr>
          <tr>
            <td colSpan="5">Water Supply</td>
            <td colSpan="3">Available</td>
          </tr>
          <tr>
            <td colSpan="5">Water Distributor</td>
            <td colSpan="3">Govt.</td>
          </tr>
          <tr>
            <td colSpan="5">Sewer Provision</td>
            <td colSpan="3">No</td>
          </tr>
          <tr>
            <td colSpan="5">Sewer Line Connected to Main Sewer</td>
            <td colSpan="3">No</td>
          </tr>
          <tr>
            <td colSpan="5">Any Demolition Threat in Future Development / Expansion</td>
            <td colSpan="3">No</td>
          </tr>
          <tr>
            <td width="75"></td>
            <td width="101"></td>
            <td width="97"></td>
            <td width="99"></td>
            <td width="99"></td>
            <td width="93"></td>
            <td width="97"></td>
            <td width="93"></td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Photo and Geo Tagging</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="2">Latitude:</td>
            <td colSpan="2">22.992641,</td>
            <td className='font-boldi' colSpan="2">Longitude:</td>
            <td colSpan="2">79.879033</td>
          </tr>
          <tr>
            <td width="75"></td>
            <td width="101"></td>
            <td width="97"></td>
            <td width="99"></td>
            <td width="99"></td>
            <td width="93"></td>
            <td width="97"></td>
            <td width="93"></td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Satellite Image</td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Declaration</td>
          </tr>
          <tr>
            <td width="75">1</td>
            <td colSpan="7">We have no direct or indirect interest in the property valued.</td>
          </tr>
          <tr>
            <td width="75">2</td>
            <td colSpan="7">The information furnished in this report is true and correct to the best of my knowledge.</td>
          </tr>
          <tr>
            <td width="75">3</td>
            <td colSpan="7">The final valuation has been concluded basis comparative market valuation approach and rates are cross-verified with the rates prevalent in the nearby localities.</td>
          </tr>
          <tr>
            <td width="75"></td>
            <td width="101"></td>
            <td width="97"></td>
            <td width="99"></td>
            <td width="99"></td>
            <td width="93"></td>
            <td width="97"></td>
            <td width="93"></td>
          </tr>
          <tr>
            <td className='font-boldi' colSpan="8">Agency Details</td>
          </tr>
          <tr>
            <td colSpan="2">Agency Name</td>
            <td colSpan="3">AMERIYA ENGINEERING PVT. LTD.</td>
            <td colSpan="2">Agency Code</td>
            <td width="93">&nbsp;</td>
          </tr>
          <tr>
            <td colSpan="2">Agency Login IP</td>
            <td colSpan="3">&nbsp;</td>
            <td colSpan="2">Agency Geo-Location</td>
            <td width="93">Longitude: , Latitude:</td>
          </tr>
          <tr>
            <td colSpan="5">Agency Username</td>
            <td colSpan="3">&nbsp;</td>
          </tr>
          <tr>
            <td colSpan="8">***********End of report***********</td>
          </tr>
        </tbody>
      </table>
    </div>
    </div>
  );
};

export default BajaAmeriya;